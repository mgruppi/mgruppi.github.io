import{T as I}from"./components.651c9e2d.js";import{_ as A}from"./nuxt-link.2bb006d9.js";import{o as n,a as r,b as s,V as i,w as l,W as T,X as k,Y as _,Z as p,$,a0 as D,a1 as b,u as x,a2 as N,x as F,c as z,f as O,p as P,e as G}from"./entry.aa775ad5.js";import{_ as q}from"./_plugin-vue_export-helper.c27b6911.js";import{_ as H}from"./PostTag.ffff7de2.js";import{_ as L}from"./client-only.37608b56.js";import{u as g,q as f}from"./query.78c1c6e7.js";import"./utils.3b862627.js";import"./preview.abae9683.js";const R={props:{posts:{required:!0},authors:{required:!0}},methods:{getDateString(a){const t=new Date(a);return t.setHours(t.getHours()+4),Intl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:"numeric",weekday:"long"}).format(t)}}},j={class:"row"},E={class:"col-12 col-lg-9 position-relative"},M={class:"post-list-item"},U={class:"h5"},W={class:"m-0"},X={class:"m-0 text-muted"},Y={key:0},Z={key:0},J={key:1};function K(a,t,o,c,d,u){const h=A;return n(),r("main",null,[s("div",j,[s("div",E,[i(D,{name:"list"},{default:l(()=>[(n(!0),r(T,null,k(o.posts,e=>(n(),r("div",{key:e.title},[i(h,{to:e._path,class:"blog-feed-link"},{default:l(()=>[s("div",M,[s("h1",U,_(e.title),1),s("p",W,_(e.description),1),s("p",X,[p(_(u.getDateString(e.date))+" ",1),e.author?(n(),r("span",Y,[p("by "),e.author in o.authors?(n(),r("span",Z,_(o.authors[e.author].name),1)):(n(),r("span",J,_(e.author),1))])):$("",!0)])])]),_:2},1032,["to"])]))),128))]),_:1})])])])}const Q=q(R,[["render",K],["__scopeId","data-v-99f763de"]]);const y=a=>(P("data-v-61bc4e17"),a=a(),G(),a),tt=y(()=>s("div",{class:"mb-4"},[s("h1",null,"Recent posts")],-1)),et={class:"row"},st={class:"col-12 col-lg-9 order-2 order-lg-1"},at={class:"col-12 col-lg-3 order-1 order-lg-2"},ot={class:"d-flex gap-2 mb-2 align-items-center"},nt=y(()=>s("h5",{class:"h5"},"Tags",-1)),rt=y(()=>s("i",{class:"fas fa-times"},null,-1)),ct={class:"d-flex flex-wrap gap-2"},it={data(){return{tags:{},tags_selected:new Set}},mounted(){this.fetchTags()},computed:{filteredArticles(){}},watch:{tags_selected:{handler(a,t){this.fetchPosts()},deep:!0}},methods:{async fetchPosts(){(await g("posts",()=>{var t=f("/blog/posts").without("body").where({_partial:!1});return this.tags_selected.size&&(t=t.where({tags:{$containsAny:Array.from(this.tags_selected)}})),t.sort({date:-1}).find()})).data},async fetchTags(){const t=await(await g("posts",()=>{var e=f("/blog/posts").without("body").where({_partial:!1});return e.sort({date:-1}).find()})).data._value,o={};for(var c in t)for(var d in t[c].tags)t[c].tags[d]in o||(o[t[c].tags[d]]=[]),o[t[c].tags[d]].push(t[c]);this.tags=o;const u=F();if(u.query.tags){const e=u.query.tags.split(",");for(var h in e)this.toggleTag(e[h])}},toggleTag(a){this.tags_selected.has(a)?this.tags_selected.delete(a):this.tags_selected.add(a)},clearTags(){this.tags_selected=new Set}}},lt=Object.assign(it,{__name:"index",async setup(a){let t,o;var d=([t,o]=b(()=>g("posts",()=>{var e=f("/blog/posts").without("body").where({_partial:!1});return e.sort({date:-1}).find()})),t=await t,o(),t).data;const h=([t,o]=b(()=>g("authors",()=>f("/blog/authors").findOne())),t=await t,o(),t).data;return(e,v)=>{const C=I,S=Q,B=H,V=L;return n(),r("main",null,[i(C,null,{default:l(()=>[p("Blog | Mauricio Gruppi")]),_:1}),tt,s("div",et,[s("div",st,[i(S,{authors:x(h),posts:x(d)},null,8,["authors","posts"])]),s("div",at,[s("div",ot,[nt,i(N,{name:"fade-in"},{default:l(()=>[e.tags_selected.size?(n(),r("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:v[0]||(v[0]=w=>e.clearTags())},[rt,p(" Clear tags ")])):$("",!0)]),_:1})]),s("div",ct,[i(V,null,{default:l(()=>[i(D,{name:"fade-in"},{default:l(()=>[(n(!0),r(T,null,k(e.tags,(w,m)=>(n(),z(B,{key:m,class:O({"tag-selected":e.tags_selected.has(m)}),onClick:_t=>e.toggleTag(m)},{default:l(()=>[p(_(m)+" ("+_(w.length)+") ",1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})])])])])}}}),wt=q(lt,[["__scopeId","data-v-61bc4e17"]]);export{wt as default};
